/*
Module: log-format-all
Description: Wrapper module to include all log-format modules
*/
argument "forward_to" {
  // comment = "The module to forward the output to"
  optional = false
}

argument "git_repo" {
  optional = true
  default = coalesce(env("GIT_REPO"), "https://github.com/grafana/agent-modules.git")
}

argument "git_rev" {
  optional = true
  default = coalesce(env("GIT_REV"), env("GIT_REVISION"), env("GIT_BRANCH"), "main")
}

argument "git_pull_freq" {
  optional = true
  default = "5m"
}

export "process" {
  value = module.git.log_format_logfmt.exports.process
}

module.git "log_format_logfmt" {
  repository = argument.git_repo.value
  revision = argument.git_rev.value
  pull_frequency = argument.git_pull_freq.value
  path = "modules/kubernetes/logs/log-formats/logfmt.river"

  arguments {
    forward_to = argument.forward_to.value
  }
}
